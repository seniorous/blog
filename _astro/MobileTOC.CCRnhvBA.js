import{o as ke,i as Ce,s as Ie}from"./lifecycle.93sJC7Cf.js";import{f as q,t as x,w as M,a as f,p as Ee,b as Le,g as t,h as m,e as L,m as H,d as u,s as y,r,c as U,y as Se}from"./utils.B7PHiYi3.js";import{s as T}from"./render.C35p3UC7.js";import{i as h}from"./if.BJgN68_l.js";import{e as ae,i as ne}from"./each.w2JWTWyQ.js";import{I as B}from"./Icon.QkT1-JiB.js";import{I as W}from"./zh_TW.B395Vq90.js";import{i as X}from"./translation.BTgvWXU-.js";import{n as ze}from"./navigation-utils.Cc6bKnia.js";import ie from"./panel-manager.BYknToDe.js";/* empty css                        */import"./props.D5mhnFgQ.js";import"./config.Rdkpnirw.js";var Pe=m('<div class="text-center py-8 text-black/50 dark:text-white/50"><!> <p>暂无文章</p></div>'),Ae=m('<div class="post-category svelte-cz3h3s"> </div>'),Oe=m('<button class="post-item svelte-cz3h3s"><div class="post-title svelte-cz3h3s"><!> </div> <!></button>'),qe=m('<div class="post-content svelte-cz3h3s"></div>'),Me=m('<div class="text-center py-8 text-black/50 dark:text-white/50"><p> </p></div>'),He=m('<span class="badge svelte-cz3h3s"> </span>'),Be=m('<span class="dot-square svelte-cz3h3s"></span>'),je=m('<span class="dot-small svelte-cz3h3s"></span>'),Je=m('<button><!> <span class="toc-text svelte-cz3h3s"> </span></button>'),Ne=m('<div class="toc-content svelte-cz3h3s"></div>'),Re=m(`<button aria-label="Table of Contents" id="mobile-toc-switch" class="btn-plain scale-animation rounded-lg h-11 w-11 active:scale-90 lg:hidden! theme-switch-btn"><!></button> <div id="mobile-toc-panel" class="float-panel float-panel-closed mobile-toc-panel absolute md:w-[20rem] w-[calc(100vw-2rem)]
		top-20 left-4 md:left-[unset] right-4 shadow-2xl rounded-2xl p-4 svelte-cz3h3s"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-bold text-(--primary)"> </h3> <button aria-label="Close TOC" class="btn-plain rounded-lg h-8 w-8 active:scale-90 theme-switch-btn"><!></button></div> <!></div>`,1);function tt(re,le){Le(le,!1);let j=H([]),J=H([]),S=H(""),b,z=H(!1),P=!1,Z=!1,$=3;const ee=async()=>{await ie.togglePanel("mobile-toc-panel")},te=async e=>{await ie.togglePanel("mobile-toc-panel",e)},ce=()=>{Z=window.siteConfig?.toc?.useJapaneseBadge||!1,$=window.siteConfig?.toc?.depth||3;const e=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),s=[],l=["ア","イ","ウ","エ","オ","カ","キ","ク","ケ","コ","サ","シ","ス","セ","ソ","タ","チ","ツ","テ","ト"];let n=0;e.forEach(d=>{if(d.id){const o=Number.parseInt(d.tagName.charAt(1),10);if(o>$)return;const a=(d.textContent||"").replace(/#+\s*$/,"");let c="";o===1&&(n++,Z&&n-1<l.length?c=l[n-1]:c=n.toString()),s.push({id:d.id,text:a,level:o,badge:c})}}),L(j,s)},de=()=>{const e=document.querySelectorAll(".card-base"),s=[];e.forEach(l=>{const n=l.querySelector('a[href*="/posts/"].transition.group'),d=l.querySelector('a[href*="/categories/"].link-lg'),o=n?.querySelector('svg[data-icon="mdi:pin"]');if(n){const a=n.getAttribute("href"),c=n.textContent?.replace(/\s+/g," ").trim()||"",i=d?.textContent?.trim()||"",v=!!o;a&&c&&s.push({title:c,url:a,category:i,pinned:v})}}),L(J,s)},ve=()=>{const e=window.location.pathname;L(z,e==="/"||e===""||/^\/\d+\/?$/.test(e))},pe=e=>{const s=document.getElementById(e);if(s){te(!1);const n=s.offsetTop-80;window.scrollTo({top:n,behavior:"smooth"})}},fe=e=>{te(!1),ze(e)},N=()=>{const e=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),s=window.scrollY,l=100;let n="";e.forEach(d=>{if(d.id){const o=d.offsetTop-l;s>=o&&(n=d.id)}}),L(S,n)},ue=()=>{const e=document.querySelectorAll("h1, h2, h3, h4, h5, h6");b&&b.disconnect(),b=new IntersectionObserver(s=>{s.forEach(l=>{l.isIntersecting&&L(S,l.target.id)})},{rootMargin:"-80px 0px -80% 0px",threshold:0}),e.forEach(s=>{s.id&&b.observe(s)})};let k=!1;const R=()=>{typeof window<"u"&&window.swup&&!k?(window.swup.hooks.on("page:view",()=>{setTimeout(()=>{C()},200)}),k=!0,console.log("MobileTOC Swup listener registered")):k||(window.addEventListener("popstate",()=>{setTimeout(C,200)}),k=!0,console.log("MobileTOC fallback listener registered"))},me=()=>{if(typeof window<"u")if(P=!!window.swup,P)R();else{const e=()=>{window.swup&&(P=!0,document.removeEventListener("swup:enable",e),R())};document.addEventListener("swup:enable",e),setTimeout(()=>{window.swup&&(P=!0,document.removeEventListener("swup:enable",e),R())},1e3)}},C=()=>{ve(),me(),t(z)?de():(ce(),ue(),N())};ke(()=>(setTimeout(C,100),window.addEventListener("scroll",N),()=>{b&&b.disconnect(),window.removeEventListener("scroll",N),typeof window<"u"&&window.swup&&window.swup.hooks.off("page:view"),window.removeEventListener("popstate",C),k=!1})),typeof window<"u"&&(window.mobileTOCInit=C),Ce();var se=Re(),A=q(se),we=u(A);B(we,{icon:"material-symbols:format-list-bulleted",class:"text-[1.25rem]"}),r(A);var oe=y(A,2),D=u(oe),K=u(D),he=u(K,!0);r(K);var V=y(K,2),be=u(V);B(be,{icon:"material-symbols:close",class:"text-[1rem]"}),r(V),r(D);var ge=y(D,2);{var _e=e=>{var s=U(),l=q(s);{var n=o=>{var a=Pe(),c=u(a);B(c,{icon:"material-symbols:article-outline",class:"text-2xl mb-2"}),Se(2),r(a),f(o,a)},d=o=>{var a=qe();ae(a,5,()=>t(J),ne,(c,i)=>{var v=Oe(),g=u(v),I=u(g);{var Y=p=>{B(p,{icon:"mdi:pin",class:"pinned-icon"})};h(I,p=>{t(i).pinned&&p(Y)})}var F=y(I);r(g);var O=y(g,2);{var G=p=>{var w=Ae(),E=u(w,!0);r(w),x(()=>T(E,t(i).category)),f(p,w)};h(O,p=>{t(i).category&&p(G)})}r(v),x(()=>T(F,` ${t(i).title??""}`)),M("click",v,()=>fe(t(i).url)),f(c,v)}),r(a),f(o,a)};h(l,o=>{t(J).length===0?o(n):o(d,!1)})}f(e,s)},xe=e=>{var s=U(),l=q(s);{var n=o=>{var a=Me(),c=u(a),i=u(c,!0);r(c),r(a),x(v=>T(i,v),[()=>X(W.tocEmpty)]),f(o,a)},d=o=>{var a=Ne();ae(a,5,()=>t(j),ne,(c,i)=>{var v=Je();let g;var I=u(v);{var Y=p=>{var w=He(),E=u(w,!0);r(w),x(()=>T(E,t(i).badge)),f(p,w)},F=p=>{var w=U(),E=q(w);{var ye=_=>{var Q=Be();f(_,Q)},Te=_=>{var Q=je();f(_,Q)};h(E,_=>{t(i).level===2?_(ye):_(Te,!1)},!0)}f(p,w)};h(I,p=>{t(i).level===1?p(Y):p(F,!1)})}var O=y(I,2),G=u(O,!0);r(O),r(v),x(()=>{g=Ie(v,1,`toc-item level-${t(i).level??""} ${t(S)===t(i).id?"active":""}`,"svelte-cz3h3s",g,{active:t(S)===t(i).id}),T(G,t(i).text)}),M("click",v,()=>pe(t(i).id)),f(c,v)}),r(a),f(o,a)};h(l,o=>{t(j).length===0?o(n):o(d,!1)})}f(e,s)};h(ge,e=>{t(z)?e(_e):e(xe,!1)})}r(oe),x(e=>T(he,e),[()=>t(z)?X(W.postList):X(W.tableOfContents)]),M("click",A,ee),M("click",V,ee),f(re,se),Ee()}export{tt as default};
