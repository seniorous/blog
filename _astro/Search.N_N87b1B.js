import{o as ie,a as le,s as J,b as P,r as K}from"./lifecycle.93sJC7Cf.js";import{l as ce,n as h,o as de,v as V,f as ue,t as W,w as y,g as t,a as Y,p as pe,b as me,e as n,d as o,s as d,h as N,r as i,x as j}from"./utils.B7PHiYi3.js";import{s as fe}from"./render.C35p3UC7.js";import{e as he,i as ve}from"./each.w2JWTWyQ.js";import{I as x,h as ge}from"./Icon.QkT1-JiB.js";import{b as q}from"./input.ChDPSwf5.js";import{I as A}from"./zh_TW.B395Vq90.js";import{i as G}from"./translation.BTgvWXU-.js";import{n as be}from"./navigation-utils.Cc6bKnia.js";import{u as H}from"./url-utils.C9mUvKoj.js";/* empty css                        */import"./if.BJgN68_l.js";import"./props.D5mhnFgQ.js";import"./config.Rdkpnirw.js";var we=N(`<a class="transition first-of-type:mt-2 lg:first-of-type:mt-0 group block
       rounded-xl text-lg px-3 py-2 hover:bg-(--btn-plain-bg-hover) active:bg-(--btn-plain-bg-active)"><div class="transition text-90 inline-flex font-bold group-hover:text-(--primary)"> <!></div> <div class="transition text-sm text-50"><!></div></a>`),ye=N(`<div class="hidden lg:block relative w-11 h-11 shrink-0"><div id="search-bar" role="button" tabindex="0" aria-label="Search"><!> <input id="search-input-desktop"/></div></div> <button aria-label="Search Panel" id="search-switch" class="btn-plain scale-animation lg:hidden! rounded-lg w-11 h-11 active:scale-90"><!></button> <div id="search-panel" class="float-panel float-panel-closed absolute md:w-120 top-20 left-4 md:left-[unset] right-4 z-50 search-panel shadow-2xl rounded-2xl p-2"><div id="search-bar-inside" class="flex relative lg:hidden transition-all items-center h-11 rounded-xl search-bar-bg svelte-1wah7ro"><!> <input class="pl-10 absolute inset-0 text-sm bg-transparent outline-0
               focus:w-60 search-input-color svelte-1wah7ro"/></div> <!></div>`,1);function Me(O,Q){me(Q,!0);let l=h(""),v=h(""),c=h(de([])),_=!1,g=h(!1),r=h(!1),k,T=!1,I,B;const xe=[{url:H("/"),meta:{title:"This Is a Fake Search Result"},excerpt:"Because the search cannot work in the <mark>dev</mark> environment."},{url:H("/"),meta:{title:"If You Want to Test the Search"},excerpt:"Try running <mark>npm build && npm preview</mark> instead."}],U=()=>{document.getElementById("search-panel")?.classList.toggle("float-panel-closed")},$=()=>{T||(n(r,!t(r)),t(r)&&setTimeout(()=>{document.getElementById("search-input-desktop")?.focus()},0))},X=()=>{t(l)||n(r,!1)},Z=()=>{B=setTimeout(()=>{n(r,!1),m(!1,!0)},200)},m=(e,a)=>{const s=document.getElementById("search-panel");!s||!a||(e?s.classList.remove("float-panel-closed"):s.classList.add("float-panel-closed"))},ee=()=>{const e=document.getElementById("search-panel");e&&e.classList.add("float-panel-closed"),n(l,""),n(v,""),n(c,[],!0)},te=(e,a)=>{e.preventDefault(),ee(),be(a)},D=async(e,a)=>{if(!e){m(!1,a),n(c,[],!0);return}if(t(g))try{let s=[];if(_&&window.pagefind){const f=await window.pagefind.search(e);s=await Promise.all(f.results.map(w=>w.data()))}else s=[],console.error("Pagefind is not available in production environment.");n(c,s,!0),m(t(c).length>0,a)}catch(s){console.error("Search error:",s),n(c,[],!0),m(!1,a)}};ie(()=>{const e=()=>{n(g,!0),_=typeof window<"u"&&!!window.pagefind&&typeof window.pagefind.search=="function",console.log("Pagefind status on init:",_)};document.addEventListener("pagefindready",()=>{console.log("Pagefind ready event received."),e()}),document.addEventListener("pagefindloaderror",()=>{console.warn("Pagefind load error event received. Search functionality will be limited."),e()}),setTimeout(()=>{t(g)||(console.log("Fallback: Initializing search after timeout."),e())},2e3);const a=()=>{T=!0,clearTimeout(I),I=setTimeout(()=>{T=!1},500)};return window.addEventListener("focus",a),()=>{window.removeEventListener("focus",a)}}),V(()=>{if(t(g)){const e=t(l)||t(v),a=!!t(l)||t(r);clearTimeout(k),e?k=setTimeout(()=>{D(e,a)},300):(n(c,[],!0),m(!1,a))}}),V(()=>{if(typeof document<"u"){const e=document.getElementById("navbar");t(r)?e?.classList.add("is-searching"):e?.classList.remove("is-searching")}}),le(()=>{typeof document<"u"&&document.getElementById("navbar")?.classList.remove("is-searching"),clearTimeout(k),clearTimeout(I)});var z=ye(),E=ue(z),u=o(E);u.__click=()=>{document.getElementById("search-input-desktop")?.focus()};var F=o(u);{let e=j(()=>t(r)?"left-3":"left-1/2 -translate-x-1/2"),a=j(()=>t(r)?"search-icon-color":"");x(F,{icon:"material-symbols:search",get class(){return`absolute text-[1.25rem] pointer-events-none ${t(e)??""} transition top-1/2 -translate-y-1/2 ${t(a)??""}`}})}var p=d(F,2);K(p),i(u),i(E);var b=d(E,2);b.__click=U;var ae=o(b);x(ae,{icon:"material-symbols:search",class:"text-[1.25rem]"}),i(b);var R=d(b,2),L=o(R),M=o(L);x(M,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto search-icon-color"});var S=d(M,2);K(S),i(L);var se=d(L,2);he(se,17,()=>t(c),ve,(e,a)=>{var s=we();s.__click=oe=>te(oe,t(a).url);var f=o(s),w=o(f,!0),re=d(w);x(re,{icon:"fa7-solid:chevron-right",class:"transition text-[0.75rem] translate-x-1 my-auto text-(--primary)"}),i(f);var C=d(f,2),ne=o(C);ge(ne,()=>t(a).excerpt),i(C),i(s),W(()=>{P(s,"href",t(a).url),fe(w,t(a).meta.title)}),Y(e,s)}),i(R),W((e,a)=>{J(u,1,`flex transition-all items-center h-11 rounded-lg absolute right-0 top-0 shrink-0
            ${t(r)?"search-bar-bg":"btn-plain active:scale-90"}
            ${t(r)?"w-48":"w-11"}`,"svelte-1wah7ro"),P(p,"placeholder",e),J(p,1,`transition-all pl-10 text-sm bg-transparent outline-0
                h-full ${t(r)?"w-36":"w-0"} search-input-color`,"svelte-1wah7ro"),P(S,"placeholder",a)},[()=>G(A.search),()=>G(A.search)]),y("mouseenter",u,()=>{t(r)||$()}),y("mouseleave",u,X),y("focus",p,()=>{clearTimeout(B),t(r)||$(),D(t(l),!0)}),y("blur",p,Z),q(p,()=>t(l),e=>n(l,e)),q(S,()=>t(v),e=>n(v,e)),Y(O,z),pe()}ce(["click"]);export{Me as default};
